{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "membership_functions.schema.json",
  "title": "Membership Function Configuration",
  "description": "Schema for fuzzy logic membership function configurations per sensor type",
  "type": "object",
  "required": ["sensor_type", "unit", "universe_of_discourse", "linguistic_variables"],
  "properties": {
    "sensor_type": {
      "type": "string",
      "pattern": "^[a-z_]+$",
      "description": "Sensor type identifier (e.g., temperature, humidity)"
    },
    "unit": {
      "type": "string",
      "description": "Unit of measurement (e.g., celsius, percent)"
    },
    "universe_of_discourse": {
      "$ref": "#/$defs/universe_of_discourse"
    },
    "confidence_threshold": {
      "type": "number",
      "minimum": 0.0,
      "maximum": 1.0,
      "default": 0.1,
      "description": "Minimum membership degree to include term in output"
    },
    "linguistic_variables": {
      "type": "array",
      "minItems": 1,
      "items": {
        "$ref": "#/$defs/linguistic_variable"
      },
      "description": "List of linguistic terms with their membership functions"
    }
  },
  "$defs": {
    "universe_of_discourse": {
      "type": "object",
      "required": ["min", "max"],
      "properties": {
        "min": {
          "type": "number",
          "description": "Minimum value of the universe of discourse"
        },
        "max": {
          "type": "number",
          "description": "Maximum value of the universe of discourse"
        }
      },
      "additionalProperties": false
    },
    "linguistic_variable": {
      "type": "object",
      "required": ["term", "function_type", "parameters"],
      "properties": {
        "term": {
          "type": "string",
          "pattern": "^[a-z_]+$",
          "description": "Linguistic term label (e.g., cold, hot, comfortable)"
        },
        "function_type": {
          "type": "string",
          "enum": ["triangular", "trapezoidal", "gaussian", "sigmoid"],
          "description": "Type of membership function"
        },
        "parameters": {
          "oneOf": [
            { "$ref": "#/$defs/triangular_params" },
            { "$ref": "#/$defs/trapezoidal_params" },
            { "$ref": "#/$defs/gaussian_params" },
            { "$ref": "#/$defs/sigmoid_params" }
          ]
        }
      },
      "allOf": [
        {
          "if": {
            "properties": { "function_type": { "const": "triangular" } }
          },
          "then": {
            "properties": {
              "parameters": { "$ref": "#/$defs/triangular_params" }
            }
          }
        },
        {
          "if": {
            "properties": { "function_type": { "const": "trapezoidal" } }
          },
          "then": {
            "properties": {
              "parameters": { "$ref": "#/$defs/trapezoidal_params" }
            }
          }
        },
        {
          "if": {
            "properties": { "function_type": { "const": "gaussian" } }
          },
          "then": {
            "properties": {
              "parameters": { "$ref": "#/$defs/gaussian_params" }
            }
          }
        },
        {
          "if": {
            "properties": { "function_type": { "const": "sigmoid" } }
          },
          "then": {
            "properties": {
              "parameters": { "$ref": "#/$defs/sigmoid_params" }
            }
          }
        }
      ],
      "additionalProperties": false
    },
    "triangular_params": {
      "type": "object",
      "required": ["a", "b", "c"],
      "properties": {
        "a": {
          "type": "number",
          "description": "Left foot of the triangle (membership = 0)"
        },
        "b": {
          "type": "number",
          "description": "Peak of the triangle (membership = 1)"
        },
        "c": {
          "type": "number",
          "description": "Right foot of the triangle (membership = 0)"
        }
      },
      "additionalProperties": false,
      "description": "Parameters for triangular membership function where a <= b <= c"
    },
    "trapezoidal_params": {
      "type": "object",
      "required": ["a", "b", "c", "d"],
      "properties": {
        "a": {
          "type": "number",
          "description": "Left foot (membership = 0)"
        },
        "b": {
          "type": "number",
          "description": "Left shoulder (membership = 1 starts)"
        },
        "c": {
          "type": "number",
          "description": "Right shoulder (membership = 1 ends)"
        },
        "d": {
          "type": "number",
          "description": "Right foot (membership = 0)"
        }
      },
      "additionalProperties": false,
      "description": "Parameters for trapezoidal membership function where a <= b <= c <= d"
    },
    "gaussian_params": {
      "type": "object",
      "required": ["mean", "sigma"],
      "properties": {
        "mean": {
          "type": "number",
          "description": "Center of the Gaussian curve (membership = 1)"
        },
        "sigma": {
          "type": "number",
          "exclusiveMinimum": 0,
          "description": "Standard deviation controlling curve width"
        }
      },
      "additionalProperties": false,
      "description": "Parameters for Gaussian membership function"
    },
    "sigmoid_params": {
      "type": "object",
      "required": ["a", "c"],
      "properties": {
        "a": {
          "type": "number",
          "description": "Slope parameter (positive = increasing, negative = decreasing)"
        },
        "c": {
          "type": "number",
          "description": "Inflection point (where membership = 0.5)"
        }
      },
      "additionalProperties": false,
      "description": "Parameters for sigmoid membership function: 1 / (1 + exp(-a * (x - c)))"
    }
  }
}
